# Makefile generated by OCamake
# http://tech.motion-twin.com
.SUFFIXES : .ml .mli .cmo .cmi .cmx .mll .mly

CFLAGS= -I ../extlib -I ../extc -g
LIBS=
LIBS_FOR_BYTE= ../extc/extc.cma

LFLAGS= -g -o swflib.cmxa -a
LFLAGS_BYTE= -g -o swflib.cma -a

MODULES=as3code.cmx png.cmx swf.cmx actionScript.cmx as3parse.cmx swfPic.cmx as3hlparse.cmx swfParser.cmx

BYTE_MODULES=as3code.cmo png.cmo swf.cmo actionScript.cmo as3parse.cmo swfPic.cmo as3hlparse.cmo swfParser.cmo

all: swflib.cmxa

swflib.cmxa: $(MODULES)
	ocamlopt $(LFLAGS) $(LIBS) $(MODULES)

byte: swflib.cma
	
swflib.cma: $(BYTE_MODULES)
	ocamlc $(LFLAGS_BYTE) $(LIBS_FOR_BYTE) $(BYTE_MODULES)

actionScript.cmx: swf.cmx

as3code.cmx: as3.cmi

as3hl.cmi: as3.cmi

as3hlparse.cmx: as3parse.cmx as3hl.cmi as3code.cmx as3.cmi

as3parse.cmx: as3code.cmx as3.cmi

png.cmx: png.cmi

swf.cmx: as3.cmi

swfParser.cmx: swf.cmx as3parse.cmx actionScript.cmx

swfPic.cmx: swf.cmx png.cmi


actionScript.cmo: swf.cmo

as3code.cmo: as3.cmi

as3hl.cmi: as3.cmi

as3hlparse.cmo: as3parse.cmo as3hl.cmi as3code.cmo as3.cmi

as3parse.cmo: as3code.cmo as3.cmi

png.cmo: png.cmi

swf.cmo: as3.cmi

swfParser.cmo: swf.cmo as3parse.cmo actionScript.cmo

swfPic.cmo: swf.cmo png.cmi

clean:
	rm -f swflib.cmxa swflib.lib swflib.a swflib.cma as3.cmi as3hl.cmi
	rm -f $(MODULES) $(MODULES:.cmx=.obj) $(MODULES:.cmx=.cmi) $(MODULES:.cmx=.o)
	rm -f $(BYTE_MODULES) $(BYTE_MODULES:.cmo=.obj) $(BYTE_MODULES:.cmo=.cmi) $(BYTE_MODULES:.cmo=.o)

# SUFFIXES
.ml.cmo:
	ocamlc $(CFLAGS) -c $<

.ml.cmx:
	ocamlopt $(CFLAGS) -c $<

.mli.cmi:
	ocamlc $(CFLAGS) $<

.mll.ml:
	ocamllex $<

.mly.ml:
	ocamlyacc $<

